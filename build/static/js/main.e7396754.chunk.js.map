{"version":3,"sources":["connection.ts","App.tsx","index.tsx"],"names":["SERVICE_UID","TEMP_IN1","TEMP_IN2","TEMP_OUT1","TEMP_OUT2","TEMP_TARGET","VOLTAGE","BATTERY_STATUS","COOLING_MODE","toString","dataView","TextDecoder","decode","buffer","toFloat","getFloat32","getCooler","a","navigator","bluetooth","Error","requestDevice","filters","services","device","gatt","connect","server","getPrimaryService","service","getCharacteristic","characteristics","tempIn1","tempIn2","tempOut1","tempOut2","tempTarget","voltage","batteryStatus","coolingMode","getData","Promise","all","readValue","App","React","useState","error","setError","state","setState","cooler","setCooler","data","setData","message","update","result","useEffect","updateTimer","setInterval","clearInterval","className","onClick","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e7396754.chunk.js","sourcesContent":["\n/* BLE GATT UIDs */\nconst SERVICE_UID       = \"199ecfda-a1f8-463f-89bb-7a698b36b2a1\";\nconst TEMP_IN1          = \"17ed73f7-f174-415f-89e2-154025a1b5da\";\nconst TEMP_IN2          = \"e743df97-33d9-40f2-a03d-273873dfcd7e\";\nconst TEMP_OUT1         = \"6eba5869-2dba-43ad-9fa5-bc60fab6abe9\";\nconst TEMP_OUT2         = \"ac255d90-c971-4d69-baa5-be6e6916d255\";\nconst TEMP_TARGET       = \"a630a2b6-398e-46ea-b4ce-d019b8afc2a5\";\nconst VOLTAGE           =  \"71442048-a860-49aa-b1c5-a163a3496fdd\";\nconst BATTERY_STATUS    = \"74ad860b-8e24-4e50-a352-116bb46fd172\";\nconst COOLING_MODE      = \"65ee7354-0f62-4c98-8673-18a3e932a886\";\n\nfunction toString(dataView: DataView) {\n    const decoder = new TextDecoder(\"utf-8\");\n    return decoder.decode(dataView.buffer);\n}\n\nfunction toFloat(dataView: DataView) {\n    return dataView.getFloat32(0);\n}\n\nexport interface CoolerData {\n    tempIn1: number;\n                tempIn2: number;\n                tempOut1: number;\n                tempOut2: number;\n                tempTarget: number;\n                voltage: number;\n                batteryStatus: \"test\";\n                coolingMode: \"test\";\n}\n\nexport interface Cooler {\n    getData(): Promise<CoolerData>;\n}\n\nexport async function getCooler(): Promise<Cooler> {\n    if(!navigator.bluetooth)\n        throw new Error(\"Bluetooth is not supported by this browser\");\n\n    const device = await navigator.bluetooth.requestDevice({ filters: [\n        { services: [SERVICE_UID] }\n    ]});\n\n    const server = await device.gatt!.connect();\n    const service = await server.getPrimaryService(SERVICE_UID);\n    \n    const characteristics = {\n        tempIn1       : await service.getCharacteristic(TEMP_IN1),\n        tempIn2       : await service.getCharacteristic(TEMP_IN2),\n        tempOut1      : await service.getCharacteristic(TEMP_OUT1),\n        tempOut2      : await service.getCharacteristic(TEMP_OUT2),\n        tempTarget    : await service.getCharacteristic(TEMP_TARGET),\n        voltage       : await service.getCharacteristic(VOLTAGE),\n        batteryStatus : await service.getCharacteristic(BATTERY_STATUS),\n        coolingMode   : await service.getCharacteristic(COOLING_MODE),\n    };\n\n    return {\n        async getData(): Promise<CoolerData> {\n            const [tempIn1, tempIn2, tempOut1, tempOut2, tempTarget, voltage, batteryStatus, coolingMode] = await Promise.all([\n                characteristics.tempIn1.readValue(),\n                characteristics.tempIn2.readValue(),\n                characteristics.tempOut1.readValue(),\n                characteristics.tempOut2.readValue(),\n                characteristics.tempTarget.readValue(),\n                characteristics.voltage.readValue(),\n                characteristics.batteryStatus.readValue(),\n                characteristics.coolingMode.readValue(),\n            ]);\n\n            return {\n                tempIn1: toFloat(tempIn1),\n                tempIn2: toFloat(tempIn2),\n                tempOut1: toFloat(tempOut1),\n                tempOut2: toFloat(tempOut2),\n                tempTarget: toFloat(tempTarget),\n                voltage: toFloat(voltage),\n                batteryStatus: toString(batteryStatus) as any,\n                coolingMode: toString(batteryStatus) as any\n            };\n        }\n    };\n}","import React from 'react';\nimport './App.css';\nimport { Cooler, CoolerData, getCooler } from './connection';\n\nfunction App() {\n  const [error, setError] = React.useState<string | null>(null);\n  const [state, setState] = React.useState<\"user-click\" | \"connecting\" | \"connected\">(\"user-click\");\n\n  const [cooler, setCooler] = React.useState<Cooler | null>(null);\n\n  const [data, setData] = React.useState<CoolerData>({ \n    batteryStatus: \"test\",\n    coolingMode: \"test\",\n    tempIn1: 0,\n    tempIn2: 0,\n    tempOut1: 0,\n    tempOut2: 0,\n    tempTarget: 0,\n    voltage: 0,\n   });\n\n  async function start() {\n      setState(\"connecting\");\n      try {\n        const cooler = await getCooler();\n        setCooler(cooler);\n        setState(\"connected\");\n      } catch(error) {\n        setError(error.message);\n      }\n  }\n\n  async function update() {\n    const result = await cooler!.getData();\n    setData(result);\n  }\n\n  React.useEffect(() => {\n    if(!cooler) return;\n\n    const updateTimer = setInterval(update, 10_000);\n    return () => clearInterval(updateTimer);\n  }, [cooler, update]);\n\n  return (\n    <div className=\"App\">\n      <h1>Kühlschrank</h1>\n\n      {error !== null && <p>Fehler: {error}</p>}\n      {state === \"connecting\" && <>verbinde...</>}\n      {state === \"user-click\" && <>\n        <button onClick={start}>\n          Start\n        </button>\n      </>}\n      {/* state === \"connected\" && */ <>\n        <p>Zieltemparatur: {data.tempTarget}°C</p>\n        <p>Innentemparatur: {data.tempIn1}°C / {data.tempIn2}°C</p>\n        <p>Außentemparatur: {data.tempOut1}°C / {data.tempOut2}°C</p>\n        <p>Spannung: {data.voltage}V</p>\n        <p>Batteriezustand: {data.batteryStatus}</p>\n        <p>Modus: {data.coolingMode}</p>\n      </>}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}