{"version":3,"sources":["connection.ts","App.tsx","index.tsx"],"names":["SERVICE_UID","TEMP_IN1","TEMP_IN2","TEMP_OUT1","TEMP_OUT2","TEMP_TARGET","VOLTAGE","BATTERY_STATUS","COOLING_MODE","toString","dataView","TextDecoder","decode","buffer","toFloat","getFloat32","getCooler","a","navigator","bluetooth","Error","requestDevice","filters","services","device","gatt","connect","server","getPrimaryService","service","console","getCharacteristics","log","getCharacteristic","characteristics","tempIn1","tempIn2","tempOut1","tempOut2","tempTarget","voltage","batteryStatus","coolingMode","getData","Promise","all","readValue","App","React","useState","error","setError","state","setState","cooler","setCooler","history","setHistory","data","setData","message","useEffect","update","updateTimer","setInterval","clearInterval","result","prev","slice","concat","time","Date","className","onClick","LineChart","width","height","XAxis","dataKey","tickFormatter","toLocaleTimeString","hour","minute","second","YAxis","CartesianGrid","stroke","strokeDasharray","Line","type","name","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.586001d7.chunk.js","sourcesContent":["\n/* BLE GATT UIDs */\nconst SERVICE_UID       = \"199ecfda-a1f8-463f-89bb-7a698b36b2a1\";\nconst TEMP_IN1          = \"17ed73f7-f174-415f-89e2-154025a1b5da\";\nconst TEMP_IN2          = \"e743df97-33d9-40f2-a03d-273873dfcd7e\";\nconst TEMP_OUT1         = \"6eba5869-2dba-43ad-9fa5-bc60fab6abe9\";\nconst TEMP_OUT2         = \"ac255d90-c971-4d69-baa5-be6e6916d255\";\nconst TEMP_TARGET       = \"a630a2b6-398e-46ea-b4ce-d019b8afc2a5\";\nconst VOLTAGE           =  \"71442048-a860-49aa-b1c5-a163a3496fdd\";\nconst BATTERY_STATUS    = \"74ad860b-8e24-4e50-a352-116bb46fd172\";\nconst COOLING_MODE      = \"df54b382-ea92-474a-a5ea-a8a2f4f73878\";\n\nfunction toString(dataView: DataView) {\n    const decoder = new TextDecoder(\"utf-8\");\n    return decoder.decode(dataView.buffer);\n}\n\nfunction toFloat(dataView: DataView) {\n    return dataView.getFloat32(0, true);\n}\n\nexport interface CoolerData {\n    tempIn1: number;\n                tempIn2: number;\n                tempOut1: number;\n                tempOut2: number;\n                tempTarget: number;\n                voltage: number;\n                batteryStatus: \"test\";\n                coolingMode: \"test\";\n}\n\nexport interface Cooler {\n    getData(): Promise<CoolerData>;\n}\n\nexport async function getCooler(): Promise<Cooler> {\n    if(!navigator.bluetooth)\n        throw new Error(\"Bluetooth wird vom Browser nicht unterstützt\");\n\n    const device = await navigator.bluetooth.requestDevice({ filters: [\n        { services: [SERVICE_UID] }\n    ]});\n\n    const server = await device.gatt!.connect();\n    const service = await server.getPrimaryService(SERVICE_UID);\n    \n    console.log(\"characteristics\", await service.getCharacteristics());\n    \n    const characteristics = {\n        tempIn1       : await service.getCharacteristic(TEMP_IN1),\n        tempIn2       : await service.getCharacteristic(TEMP_IN2),\n        tempOut1      : await service.getCharacteristic(TEMP_OUT1),\n        tempOut2      : await service.getCharacteristic(TEMP_OUT2),\n        tempTarget    : await service.getCharacteristic(TEMP_TARGET),\n        voltage       : await service.getCharacteristic(VOLTAGE),\n        batteryStatus : await service.getCharacteristic(BATTERY_STATUS),\n        coolingMode   : await service.getCharacteristic(COOLING_MODE),\n    };\n\n    return {\n        async getData(): Promise<CoolerData> {\n            const [tempIn1, tempIn2, tempOut1, tempOut2, tempTarget, voltage, batteryStatus, coolingMode] = await Promise.all([\n                characteristics.tempIn1.readValue(),\n                characteristics.tempIn2.readValue(),\n                characteristics.tempOut1.readValue(),\n                characteristics.tempOut2.readValue(),\n                characteristics.tempTarget.readValue(),\n                characteristics.voltage.readValue(),\n                characteristics.batteryStatus.readValue(),\n                characteristics.coolingMode.readValue()\n            ]);\n\n            console.log(\"getData - tempIn1\", tempIn1);\n\n            return {\n                tempIn1: toFloat(tempIn1),\n                tempIn2: toFloat(tempIn2),\n                tempOut1: toFloat(tempOut1),\n                tempOut2: toFloat(tempOut2),\n                tempTarget: toFloat(tempTarget),\n                voltage: toFloat(voltage),\n                batteryStatus: toString(batteryStatus) as any,\n                coolingMode: toString(coolingMode) as any\n            };\n        }\n    };\n}","import React from 'react';\nimport './App.css';\nimport { Cooler, CoolerData, getCooler } from './connection';\nimport { CartesianGrid, Line, LineChart, XAxis, YAxis } from \"recharts\";\n\nfunction App() {\n  const [error, setError] = React.useState<string | null>(null);\n  const [state, setState] = React.useState<\"user-click\" | \"connecting\" | \"connected\">(\"user-click\");\n\n  const [cooler, setCooler] = React.useState<Cooler | null>(null);\n\n  const [history, setHistory] = React.useState<(CoolerData & { time: Date })[]>([\n    /* {\n      batteryStatus: \"test\",\n      coolingMode: \"test\",\n      tempIn1: 20,\n      tempIn2: 21,\n      tempOut1: 22,\n      tempOut2: 23, \n      tempTarget: 5,\n      voltage: 10,\n      time: new Date(1000)\n    }, \n    {\n      batteryStatus: \"test\",\n      coolingMode: \"test\",\n      tempIn1: 9,\n      tempIn2: 8,\n      tempOut1: 24,\n      tempOut2: 25, \n      tempTarget: 5,\n      voltage: 10,\n      time: new Date(2000)\n    },\n    {\n      batteryStatus: \"test\",\n      coolingMode: \"test\",\n      tempIn1: 6,\n      tempIn2: 7,\n      tempOut1: 23,\n      tempOut2: 22, \n      tempTarget: 5,\n      voltage: 10,\n      time: new Date(3000)\n    },\n    {\n      batteryStatus: \"test\",\n      coolingMode: \"test\",\n      tempIn1: 5,\n      tempIn2: 4,\n      tempOut1: 24,\n      tempOut2: 25, \n      tempTarget: 5,\n      voltage: 10,\n      time: new Date(4000)\n    } */\n  ]);\n\n  const [data, setData] = React.useState<CoolerData>({\n    batteryStatus: \"test\",\n    coolingMode: \"test\",\n    tempIn1: 5,\n    tempIn2: 5,\n    tempOut1: 24,\n    tempOut2: 25,\n    tempTarget: 5,\n    voltage: 0,\n  });\n\n  async function start() {\n    setState(\"connecting\");\n    try {\n      const cooler = await getCooler();\n      setCooler(cooler);\n      setState(\"connected\");\n    } catch (error) {\n      setError(error.message);\n    }\n  }\n\n\n\n  React.useEffect(() => {\n    if (!cooler) return;\n\n    async function update() {\n      const result = await cooler!.getData();\n      setData(result);\n      setHistory(prev => prev.slice(-100).concat({ ...result, time: new Date() }));\n    }\n\n    update();\n\n    const updateTimer = setInterval(update, 10_000);\n    return () => clearInterval(updateTimer);\n  }, [cooler]);\n\n  return (\n    <div className=\"App\">\n      <div className=\"container\">\n        <h1>Kühlschrank</h1>\n\n        {error !== null && <p className=\"error\">Fehler: {error}</p>}\n        {state === \"user-click\" && <>\n          <button onClick={start}>\n            Gerät koppeln\n        </button>\n        </>}\n      </div>\n\n\n      {/* state === \"connected\" && */ <>\n        <div className=\"container\">\n          <div className=\"values\">\n            <div className=\"value\">\n              <div className=\"value__key\">Modus</div>\n              <div className=\"value__value\">{data.coolingMode}</div>\n            </div>\n            <div className=\"value\">\n              <div className=\"value__key\">Zieltemparatur</div>\n              <div className=\"value__value\">{data.tempTarget}°</div>\n            </div>\n          </div>\n        </div>\n        <div className=\"container\">\n          <div className=\"values\">\n            <div className=\"value\">\n              <div className=\"value__key\">Innentemparatur</div>\n              <div className=\"value__value\">{data.tempIn1}° / {data.tempIn2}°</div>\n            </div>\n            <div className=\"value\">\n              <div className=\"value__key\">Außentemparatur</div>\n              <div className=\"value__value\">{data.tempOut1}° / {data.tempOut2}°</div>\n            </div>\n          </div>\n\n          <LineChart data={history} width={900} height={250}>\n            <XAxis dataKey=\"time\" tickFormatter={(time: Date) => time?.toLocaleTimeString(\"de-DE\", { hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" }) ?? \"unbekannt\"} />\n            <YAxis />\n            <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n\n            <Line type=\"monotone\" dataKey=\"tempIn1\" stroke=\"var(--primary)\" name=\"Innentemparatur 1\"/>\n            <Line type=\"monotone\" dataKey=\"tempIn2\" stroke=\"var(--primary)\" name=\"Innentemparatur 2\"/>\n            <Line type=\"monotone\" dataKey=\"tempOut1\" stroke=\"var(--orange)\" name=\"Außentemparatur 1\"/>\n            <Line type=\"monotone\" dataKey=\"tempOut2\" stroke=\"var(--orange)\" name=\"Außentemparatur 2\"/>\n            <Line type=\"monotone\" dataKey=\"tempTarget\" stroke=\"var(--green)\" name=\"Zieltemparatur\" />\n          </LineChart>\n        </div>\n\n\n        <div className=\"container\">\n          <div className=\"values\">\n            <div className=\"value\">\n              <div className=\"value__key\">Spannung</div>\n              <div className=\"value__value\">{data.voltage}V</div>\n            </div>\n            <div className=\"value\">\n              <div className=\"value__key\">Batteriezustand</div>\n              <div className=\"value__value\">{data.batteryStatus}</div>\n            </div>\n          </div>\n        </div>\n      </>}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}