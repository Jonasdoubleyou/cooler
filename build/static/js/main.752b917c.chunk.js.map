{"version":3,"sources":["connection.ts","App.tsx","index.tsx"],"names":["SERVICE_UID","TEMP_IN1","TEMP_IN2","TEMP_OUT1","TEMP_OUT2","TEMP_TARGET","VOLTAGE","BATTERY_STATUS","COOLING_MODE","toString","dataView","TextDecoder","decode","buffer","toFloat","getFloat32","getCooler","a","navigator","bluetooth","Error","requestDevice","filters","services","device","gatt","connect","server","getPrimaryService","service","getCharacteristic","characteristics","tempIn1","tempIn2","tempOut1","tempOut2","tempTarget","voltage","batteryStatus","coolingMode","getData","Promise","all","readValue","console","log","App","React","useState","error","setError","state","setState","cooler","setCooler","data","setData","message","useEffect","update","updateTimer","setInterval","clearInterval","result","className","onClick","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"kOAEMA,G,MAAoB,wCACpBC,EAAoB,uCACpBC,EAAoB,uCACpBC,EAAoB,uCACpBC,EAAoB,uCACpBC,EAAoB,uCACpBC,EAAqB,uCACrBC,EAAoB,uCACpBC,EAAoB,uCAE1B,SAASC,EAASC,GAEd,OADgB,IAAIC,YAAY,SACjBC,OAAOF,EAASG,QAGnC,SAASC,EAAQJ,GACb,OAAOA,EAASK,WAAW,GAAG,GAkB3B,SAAeC,IAAtB,+B,4CAAO,kCAAAC,EAAA,yDACCC,UAAUC,UADX,sBAEO,IAAIC,MAAM,mDAFjB,uBAIkBF,UAAUC,UAAUE,cAAc,CAAEC,QAAS,CAC9D,CAAEC,SAAU,CAACvB,OALd,cAIGwB,EAJH,gBAQkBA,EAAOC,KAAMC,UAR/B,cAQGC,EARH,iBASmBA,EAAOC,kBAAkB5B,GAT5C,eASG6B,EATH,iBAYuBA,EAAQC,kBAAkB7B,GAZjD,qCAauB4B,EAAQC,kBAAkB5B,GAbjD,qCAcuB2B,EAAQC,kBAAkB3B,GAdjD,qCAeuB0B,EAAQC,kBAAkB1B,GAfjD,qCAgBuByB,EAAQC,kBAAkBzB,GAhBjD,qCAiBuBwB,EAAQC,kBAAkBxB,GAjBjD,qCAkBuBuB,EAAQC,kBAAkBvB,GAlBjD,qCAmBuBsB,EAAQC,kBAAkBtB,GAnBjD,2BAWGuB,EAXH,CAYCC,QAZD,KAaCC,QAbD,KAcCC,SAdD,KAeCC,SAfD,KAgBCC,WAhBD,KAiBCC,QAjBD,KAkBCC,cAlBD,KAmBCC,YAnBD,wBAsBI,CACGC,QADH,WACmC,OAAD,4IACqEC,QAAQC,IAAI,CAC9GX,EAAgBC,QAAQW,YACxBZ,EAAgBE,QAAQU,YACxBZ,EAAgBG,SAASS,YACzBZ,EAAgBI,SAASQ,YACzBZ,EAAgBK,WAAWO,YAC3BZ,EAAgBM,QAAQM,YACxBZ,EAAgBO,cAAcK,YAC9BZ,EAAgBQ,YAAYI,cATC,0CAC1BX,EAD0B,KACjBC,EADiB,KACRC,EADQ,KACEC,EADF,KACYC,EADZ,KACwBC,EADxB,KACiCC,EADjC,KACgDC,EADhD,KAYjCK,QAAQC,IAAI,oBAAqBb,GAZA,kBAc1B,CACHA,QAASlB,EAAQkB,GACjBC,QAASnB,EAAQmB,GACjBC,SAAUpB,EAAQoB,GAClBC,SAAUrB,EAAQqB,GAClBC,WAAYtB,EAAQsB,GACpBC,QAASvB,EAAQuB,GACjBC,cAAe7B,EAAS6B,GACxBC,YAAa9B,EAAS8B,KAtBO,iDAvBtC,6C,iCCqDQO,MArFf,WAAgB,IAAD,EACaC,IAAMC,SAAwB,MAD3C,mBACNC,EADM,KACCC,EADD,OAEaH,IAAMC,SAAoD,cAFvE,mBAENG,EAFM,KAECC,EAFD,OAIeL,IAAMC,SAAwB,MAJ7C,mBAINK,EAJM,KAIEC,EAJF,OAMWP,IAAMC,SAAqB,CACjDV,cAAe,OACfC,YAAa,OACbP,QAAS,EACTC,QAAS,EACTC,SAAU,EACVC,SAAU,EACVC,WAAY,EACZC,QAAS,IAdE,mBAMNkB,EANM,KAMAC,EANA,iDAiBb,4BAAAvC,EAAA,6DACImC,EAAS,cADb,kBAG2BpC,IAH3B,OAGYqC,EAHZ,OAIMC,EAAUD,GACVD,EAAS,aALf,gDAOMF,EAAS,KAAMO,SAPrB,0DAjBa,sBA4Cb,OAdAV,IAAMW,WAAU,WACd,GAAIL,EAAJ,CAOAM,IAEA,IAAMC,EAAcC,YAAYF,EAAQ,KACxC,OAAO,kBAAMG,cAAcF,IAXP,SAGLD,IAHK,2EAGpB,4BAAA1C,EAAA,sEACuBoC,EAAQb,UAD/B,OACQuB,EADR,OAEEP,EAAQO,GAFV,4CAHoB,yBAYnB,CAACV,IAGF,sBAAKW,UAAU,MAAf,UACE,gDAEW,OAAVf,GAAkB,oBAAGe,UAAU,QAAb,qBAA8Bf,KACtC,eAAVE,GAA0B,mDAChB,eAAVA,GAA0B,mCACzB,wBAAQc,QAnDD,2CAmDP,gCAI8B,qCAChC,sBAAKD,UAAU,QAAf,UACE,qBAAKA,UAAU,aAAf,4BACA,sBAAKA,UAAU,eAAf,UAA+BT,EAAKnB,WAApC,aAEF,sBAAK4B,UAAU,sBAAf,UACE,qBAAKA,UAAU,aAAf,6BACA,sBAAKA,UAAU,eAAf,UAA+BT,EAAKvB,QAApC,UAAiDuB,EAAKtB,QAAtD,aAEF,sBAAK+B,UAAU,QAAf,UACI,qBAAKA,UAAU,aAAf,gCACA,sBAAKA,UAAU,eAAf,UAA+BT,EAAKrB,SAApC,UAAkDqB,EAAKpB,SAAvD,aAEF,sBAAK6B,UAAU,sBAAf,UACE,qBAAKA,UAAU,aAAf,sBACA,sBAAKA,UAAU,eAAf,UAA+BT,EAAKlB,QAApC,UAEF,sBAAK2B,UAAU,QAAf,UACE,qBAAKA,UAAU,aAAf,6BACA,qBAAKA,UAAU,eAAf,SAA+BT,EAAKjB,mBAEtC,sBAAK0B,UAAU,sBAAf,UACE,qBAAKA,UAAU,aAAf,mBACA,qBAAKA,UAAU,eAAf,SAA+BT,EAAKhB,wBC7E9C2B,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.752b917c.chunk.js","sourcesContent":["\n/* BLE GATT UIDs */\nconst SERVICE_UID       = \"199ecfda-a1f8-463f-89bb-7a698b36b2a1\";\nconst TEMP_IN1          = \"17ed73f7-f174-415f-89e2-154025a1b5da\";\nconst TEMP_IN2          = \"e743df97-33d9-40f2-a03d-273873dfcd7e\";\nconst TEMP_OUT1         = \"6eba5869-2dba-43ad-9fa5-bc60fab6abe9\";\nconst TEMP_OUT2         = \"ac255d90-c971-4d69-baa5-be6e6916d255\";\nconst TEMP_TARGET       = \"a630a2b6-398e-46ea-b4ce-d019b8afc2a5\";\nconst VOLTAGE           =  \"71442048-a860-49aa-b1c5-a163a3496fdd\";\nconst BATTERY_STATUS    = \"74ad860b-8e24-4e50-a352-116bb46fd172\";\nconst COOLING_MODE      = \"df54b382-ea92-474a-a5ea-a8a2f4f73878\";\n\nfunction toString(dataView: DataView) {\n    const decoder = new TextDecoder(\"utf-8\");\n    return decoder.decode(dataView.buffer);\n}\n\nfunction toFloat(dataView: DataView) {\n    return dataView.getFloat32(0, true);\n}\n\nexport interface CoolerData {\n    tempIn1: number;\n                tempIn2: number;\n                tempOut1: number;\n                tempOut2: number;\n                tempTarget: number;\n                voltage: number;\n                batteryStatus: \"test\";\n                coolingMode: \"test\";\n}\n\nexport interface Cooler {\n    getData(): Promise<CoolerData>;\n}\n\nexport async function getCooler(): Promise<Cooler> {\n    if(!navigator.bluetooth)\n        throw new Error(\"Bluetooth wird vom Browser nicht unterstützt\");\n\n    const device = await navigator.bluetooth.requestDevice({ filters: [\n        { services: [SERVICE_UID] }\n    ]});\n\n    const server = await device.gatt!.connect();\n    const service = await server.getPrimaryService(SERVICE_UID);\n    \n    const characteristics = {\n        tempIn1       : await service.getCharacteristic(TEMP_IN1),\n        tempIn2       : await service.getCharacteristic(TEMP_IN2),\n        tempOut1      : await service.getCharacteristic(TEMP_OUT1),\n        tempOut2      : await service.getCharacteristic(TEMP_OUT2),\n        tempTarget    : await service.getCharacteristic(TEMP_TARGET),\n        voltage       : await service.getCharacteristic(VOLTAGE),\n        batteryStatus : await service.getCharacteristic(BATTERY_STATUS),\n        coolingMode   : await service.getCharacteristic(COOLING_MODE),\n    };\n\n    return {\n        async getData(): Promise<CoolerData> {\n            const [tempIn1, tempIn2, tempOut1, tempOut2, tempTarget, voltage, batteryStatus, coolingMode] = await Promise.all([\n                characteristics.tempIn1.readValue(),\n                characteristics.tempIn2.readValue(),\n                characteristics.tempOut1.readValue(),\n                characteristics.tempOut2.readValue(),\n                characteristics.tempTarget.readValue(),\n                characteristics.voltage.readValue(),\n                characteristics.batteryStatus.readValue(),\n                characteristics.coolingMode.readValue()\n            ]);\n\n            console.log(\"getData - tempIn1\", tempIn1);\n\n            return {\n                tempIn1: toFloat(tempIn1),\n                tempIn2: toFloat(tempIn2),\n                tempOut1: toFloat(tempOut1),\n                tempOut2: toFloat(tempOut2),\n                tempTarget: toFloat(tempTarget),\n                voltage: toFloat(voltage),\n                batteryStatus: toString(batteryStatus) as any,\n                coolingMode: toString(coolingMode) as any\n            };\n        }\n    };\n}","import React from 'react';\nimport './App.css';\nimport { Cooler, CoolerData, getCooler } from './connection';\n\nfunction App() {\n  const [error, setError] = React.useState<string | null>(null);\n  const [state, setState] = React.useState<\"user-click\" | \"connecting\" | \"connected\">(\"user-click\");\n\n  const [cooler, setCooler] = React.useState<Cooler | null>(null);\n\n  const [data, setData] = React.useState<CoolerData>({ \n    batteryStatus: \"test\",\n    coolingMode: \"test\",\n    tempIn1: 0,\n    tempIn2: 0,\n    tempOut1: 0,\n    tempOut2: 0,\n    tempTarget: 0,\n    voltage: 0,\n   });\n\n  async function start() {\n      setState(\"connecting\");\n      try {\n        const cooler = await getCooler();\n        setCooler(cooler);\n        setState(\"connected\");\n      } catch(error) {\n        setError(error.message);\n      }\n  }\n\n  \n\n  React.useEffect(() => {\n    if(!cooler) return;\n\n    async function update() {\n      const result = await cooler!.getData();\n      setData(result);\n    }\n    \n    update();\n\n    const updateTimer = setInterval(update, 10_000);\n    return () => clearInterval(updateTimer);\n  }, [cooler]);\n\n  return (\n    <div className=\"App\">\n      <h1>Kühlschrank</h1>\n\n      {error !== null && <p className=\"error\">Fehler: {error}</p>}\n      {state === \"connecting\" && <>verbinde...</>}\n      {state === \"user-click\" && <>\n        <button onClick={start}>\n          Gerät koppeln\n        </button>\n      </>}\n      {/* state === \"connected\" && */ <>\n      <div className=\"value\">\n        <div className=\"value__key\">Zieltemparatur</div>\n        <div className=\"value__value\">{data.tempTarget}°</div>\n      </div>\n      <div className=\"value value__invert\">\n        <div className=\"value__key\">Innentemparatur</div>\n        <div className=\"value__value\">{data.tempIn1}° / {data.tempIn2}°</div>\n      </div>\n      <div className=\"value\">\n          <div className=\"value__key\">Außentemparatur</div>\n          <div className=\"value__value\">{data.tempOut1}° / {data.tempOut2}°</div>\n        </div>\n        <div className=\"value value__invert\">\n          <div className=\"value__key\">Spannung</div>\n          <div className=\"value__value\">{data.voltage}V</div>\n        </div>\n        <div className=\"value\">\n          <div className=\"value__key\">Batteriezustand</div>\n          <div className=\"value__value\">{data.batteryStatus}</div>\n        </div>\n        <div className=\"value value__invert\">\n          <div className=\"value__key\">Modus</div>\n          <div className=\"value__value\">{data.coolingMode}</div>\n        </div>\n      </>}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}